<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Front End Interview | 客户端存储</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/front-end-interview/assets/css/30.styles.fd504cf3.css" as="style"><link rel="preload" href="/front-end-interview/assets/js/app.db72fc95.js" as="script"><link rel="preload" href="/front-end-interview/assets/js/0.bf775a11.js" as="script"><link rel="prefetch" href="/front-end-interview/assets/js/12.3c29124f.js"><link rel="prefetch" href="/front-end-interview/assets/js/1.1190d708.js"><link rel="prefetch" href="/front-end-interview/assets/js/2.5de7ca40.js"><link rel="prefetch" href="/front-end-interview/assets/js/3.f70d72bc.js"><link rel="prefetch" href="/front-end-interview/assets/js/4.a541e70b.js"><link rel="prefetch" href="/front-end-interview/assets/js/5.5c894db1.js"><link rel="prefetch" href="/front-end-interview/assets/js/6.98ce2f58.js"><link rel="prefetch" href="/front-end-interview/assets/js/7.c976c70d.js"><link rel="prefetch" href="/front-end-interview/assets/js/8.69b104a6.js"><link rel="prefetch" href="/front-end-interview/assets/js/9.082b8ac0.js"><link rel="prefetch" href="/front-end-interview/assets/js/10.a347006c.js"><link rel="prefetch" href="/front-end-interview/assets/js/11.4f688f0a.js"><link rel="prefetch" href="/front-end-interview/assets/js/13.66c864b0.js"><link rel="prefetch" href="/front-end-interview/assets/js/14.13130231.js"><link rel="prefetch" href="/front-end-interview/assets/js/15.dcc3d7af.js"><link rel="prefetch" href="/front-end-interview/assets/js/16.21fc58fd.js"><link rel="prefetch" href="/front-end-interview/assets/js/17.2b64bdc6.js"><link rel="prefetch" href="/front-end-interview/assets/js/18.d801340d.js"><link rel="prefetch" href="/front-end-interview/assets/js/19.5a161372.js"><link rel="prefetch" href="/front-end-interview/assets/js/20.ee552e08.js"><link rel="prefetch" href="/front-end-interview/assets/js/21.8031b3ff.js"><link rel="prefetch" href="/front-end-interview/assets/js/22.8ffcc061.js"><link rel="prefetch" href="/front-end-interview/assets/js/23.86599a03.js"><link rel="prefetch" href="/front-end-interview/assets/js/24.139449ee.js"><link rel="prefetch" href="/front-end-interview/assets/js/25.3345fd47.js"><link rel="prefetch" href="/front-end-interview/assets/js/26.a505ed06.js"><link rel="prefetch" href="/front-end-interview/assets/js/27.58a5efca.js"><link rel="prefetch" href="/front-end-interview/assets/js/28.78d7c9b3.js"><link rel="prefetch" href="/front-end-interview/assets/js/29.b53cf265.js">
    <link rel="stylesheet" href="/front-end-interview/assets/css/30.styles.fd504cf3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/front-end-interview/" class="home-link router-link-active"><!----><span class="site-name">
      Front End Interview
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-interview/" class="nav-link">主页</a></div><div class="nav-item"><a href="/front-end-interview/SUMMARY.html" class="nav-link">目录</a></div><a href="https://github.com/lbwa/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-interview/" class="nav-link">主页</a></div><div class="nav-item"><a href="/front-end-interview/SUMMARY.html" class="nav-link">目录</a></div><a href="https://github.com/lbwa/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Web API</span><!----></p><ul class="sidebar-group-items"><li><a href="/front-end-interview/web-api/web-api-document-object-model.html" class="sidebar-link">DOM</a></li><li><a href="/front-end-interview/web-api/web-api-broswer-object-model.html" class="sidebar-link">BOM</a></li><li><a href="/front-end-interview/web-api/web-api-event.html" class="sidebar-link">事件绑定</a></li><li><a href="/front-end-interview/web-api/web-api-ajax/web-api-ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/front-end-interview/web-api/web-api-storage.html" class="active sidebar-link">客户端存储</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-interview/web-api/web-api-storage.html#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/front-end-interview/web-api/web-api-storage.html#localstorage" class="sidebar-link">localStorage</a></li><li class="sidebar-sub-header"><a href="/front-end-interview/web-api/web-api-storage.html#sessionstorage" class="sidebar-link">sessionStorage</a></li><li class="sidebar-sub-header"><a href="/front-end-interview/web-api/web-api-storage.html#拓展" class="sidebar-link">拓展</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="客户端存储"><a href="#客户端存储" aria-hidden="true" class="header-anchor">#</a> 客户端存储</h1><p>常见方法：</p><ul><li><p>cookie - 请求头部的一项</p><ul><li>本身用于客户端和服务端通信（主业），但它有本地存储（副业）的功能</li></ul></li><li><p>localStorage（<a href="https://www.w3.org/TR/webstorage/#the-localstorage-attribute" target="_blank" rel="noopener noreferrer">W3C<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>） - 本地存储 - 有同源限制</p><ul><li>本地存储空间只对同源地址有效，非同源情况下将会建立新的存储空间</li></ul></li><li><p>sessionStorage（<a href="https://www.w3.org/TR/webstorage/#the-sessionstorage-attribute" target="_blank" rel="noopener noreferrer">W3C<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>） - 会话存储 - 有同源限制</p><ul><li>只在当前会话阶段有效的存储空间，并且刷新页面不会清空当前 <code>sessionStorage</code></li></ul></li><li><p>IndexedDB（<a href="https://www.w3.org/TR/IndexedDB/" target="_blank" rel="noopener noreferrer">W3C<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>） - 本质是数据库</p><ul><li>用于存储大量结构化数据，需要维护版本等配置</li></ul></li></ul><h2 id="cookie"><a href="#cookie" aria-hidden="true" class="header-anchor">#</a> cookie</h2><p>本身是作为请求头部（<code>Request header</code>）的一个选项存在，用于在每次与服务端通信时，发送信息。</p><ul><li><p>局限性：</p><ul><li>因为它每次都会随请求发送到服务端，那么它本地存储的空间就肯定比一般存储方式要小很多（5KB）。</li><li>每次 <code>http</code> 请求都会携带 <code>cookie</code> ，那么对获取资源的效率有影响</li><li>API 过于简单，即 <code>document.cookie = '...'</code>。使用 <code>cookie</code> 存储数据就需要先封装方法才能使用。</li></ul></li></ul><h2 id="localstorage"><a href="#localstorage" aria-hidden="true" class="header-anchor">#</a> localStorage</h2><p><code>localStorage</code> 和 <code>sessionStorage</code> 都遵循同源策略。非同源地址都有自己独享的本地存储空间或会话存储空间。</p><p>现阶段，<code>localStorage</code> 在大部分浏览器的容量上限是 5MB。</p><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 保存数据</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'John Wick'</span><span class="token punctuation">)</span>

<span class="token comment">// 读取数据</span>
localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span> <span class="token comment">// 'John Wick'</span>

<span class="token comment">// 删除数据</span>
localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>

<span class="token comment">// 清空当前源的 localStorage</span>
localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>localStorage 默认没有过期设置，存储了就一直存在，除非主动清理。</p><h2 id="sessionstorage"><a href="#sessionstorage" aria-hidden="true" class="header-anchor">#</a> sessionStorage</h2><p>现阶段，<code>sessionStorage</code> 在大部分浏览器的容量上限是 5MB。</p><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 保存数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'John Wick'</span><span class="token punctuation">)</span>

<span class="token comment">// 读取数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span> <span class="token comment">// 'John Wick'</span>

<span class="token comment">// 删除数据</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>

<span class="token comment">// 清空当前源的 sessionStorage</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>sessionStorage</code> 的存储空间<strong>仅</strong>在<strong>当前会话</strong>中有效，退出当前会话，即关闭窗口会重置 <code>sessionStorage</code>。重新加载页面并<strong>不会</strong>重置当前 <code>sessionStorage</code>。</p><h2 id="拓展"><a href="#拓展" aria-hidden="true" class="header-anchor">#</a> 拓展</h2><p>ios safari 的隐藏模式下，<code>localStorage.getItem</code> 会报错。所以使用 <code>localStorage</code> 和 <code>sessionStorage</code> 最好封装在 <code>try ... catch</code> 中。</p></div><div class="content edit-link"><!----><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">6/1/2018, 5:24:28 PM</span></div></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/front-end-interview/web-api/web-api-ajax/web-api-ajax.html" class="prev">
          Ajax
        </a></span><!----></p></div></div></div></div>
    <script src="/front-end-interview/assets/js/0.bf775a11.js" defer></script><script src="/front-end-interview/assets/js/app.db72fc95.js" defer></script>
  </body>
</html>
