<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Front End Interview | 作用域</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/front-end-interview/assets/css/30.styles.fd504cf3.css" as="style"><link rel="preload" href="/front-end-interview/assets/js/app.db72fc95.js" as="script"><link rel="preload" href="/front-end-interview/assets/js/13.66c864b0.js" as="script"><link rel="prefetch" href="/front-end-interview/assets/js/12.3c29124f.js"><link rel="prefetch" href="/front-end-interview/assets/js/0.bf775a11.js"><link rel="prefetch" href="/front-end-interview/assets/js/1.1190d708.js"><link rel="prefetch" href="/front-end-interview/assets/js/2.5de7ca40.js"><link rel="prefetch" href="/front-end-interview/assets/js/3.f70d72bc.js"><link rel="prefetch" href="/front-end-interview/assets/js/4.a541e70b.js"><link rel="prefetch" href="/front-end-interview/assets/js/5.5c894db1.js"><link rel="prefetch" href="/front-end-interview/assets/js/6.98ce2f58.js"><link rel="prefetch" href="/front-end-interview/assets/js/7.c976c70d.js"><link rel="prefetch" href="/front-end-interview/assets/js/8.69b104a6.js"><link rel="prefetch" href="/front-end-interview/assets/js/9.082b8ac0.js"><link rel="prefetch" href="/front-end-interview/assets/js/10.a347006c.js"><link rel="prefetch" href="/front-end-interview/assets/js/11.4f688f0a.js"><link rel="prefetch" href="/front-end-interview/assets/js/14.13130231.js"><link rel="prefetch" href="/front-end-interview/assets/js/15.dcc3d7af.js"><link rel="prefetch" href="/front-end-interview/assets/js/16.21fc58fd.js"><link rel="prefetch" href="/front-end-interview/assets/js/17.2b64bdc6.js"><link rel="prefetch" href="/front-end-interview/assets/js/18.d801340d.js"><link rel="prefetch" href="/front-end-interview/assets/js/19.5a161372.js"><link rel="prefetch" href="/front-end-interview/assets/js/20.ee552e08.js"><link rel="prefetch" href="/front-end-interview/assets/js/21.8031b3ff.js"><link rel="prefetch" href="/front-end-interview/assets/js/22.8ffcc061.js"><link rel="prefetch" href="/front-end-interview/assets/js/23.86599a03.js"><link rel="prefetch" href="/front-end-interview/assets/js/24.139449ee.js"><link rel="prefetch" href="/front-end-interview/assets/js/25.3345fd47.js"><link rel="prefetch" href="/front-end-interview/assets/js/26.a505ed06.js"><link rel="prefetch" href="/front-end-interview/assets/js/27.58a5efca.js"><link rel="prefetch" href="/front-end-interview/assets/js/28.78d7c9b3.js"><link rel="prefetch" href="/front-end-interview/assets/js/29.b53cf265.js">
    <link rel="stylesheet" href="/front-end-interview/assets/css/30.styles.fd504cf3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/front-end-interview/" class="home-link router-link-active"><!----><span class="site-name">
      Front End Interview
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-interview/" class="nav-link">主页</a></div><div class="nav-item"><a href="/front-end-interview/SUMMARY.html" class="nav-link">目录</a></div><a href="https://github.com/lbwa/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-interview/" class="nav-link">主页</a></div><div class="nav-item"><a href="/front-end-interview/SUMMARY.html" class="nav-link">目录</a></div><a href="https://github.com/lbwa/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>基础</span><!----></p><ul class="sidebar-group-items"><li><a href="/front-end-interview/js-essentials/js-variable.html" class="sidebar-link">变量</a></li><li><a href="/front-end-interview/js-essentials/js-hoisting.html" class="sidebar-link">变量提升</a></li><li><a href="/front-end-interview/js-essentials/js-lexical-environments.html" class="active sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-interview/js-essentials/js-lexical-environments.html#作用域链" class="sidebar-link">作用域链</a></li><li class="sidebar-sub-header"><a href="/front-end-interview/js-essentials/js-lexical-environments.html#闭包" class="sidebar-link">闭包</a></li></ul></li><li><a href="/front-end-interview/js-essentials/js-prototype.html" class="sidebar-link">原型和原型链</a></li><li><a href="/front-end-interview/js-essentials/js-prototype-application.html" class="sidebar-link">原型的实际应用</a></li><li><a href="/front-end-interview/js-essentials/js-object-this.html" class="sidebar-link">函数 this 对象</a></li><li><a href="/front-end-interview/js-essentials/js-execution-context/js-execution-context.html" class="sidebar-link">执行上下文</a></li><li><a href="/front-end-interview/js-essentials/js-async.html" class="sidebar-link">异步执行</a></li><li><a href="/front-end-interview/js-essentials/js-event-loops.html" class="sidebar-link">事件循环 event loop</a></li><li><a href="/front-end-interview/js-essentials/js-promise.html" class="sidebar-link">Promise 对象</a></li><li><a href="/front-end-interview/js-essentials/js-async-function.html" class="sidebar-link">async 函数</a></li><li><a href="/front-end-interview/js-essentials/js-modules.html" class="sidebar-link">模块化</a></li><li><a href="/front-end-interview/js-essentials/js-class.html" class="sidebar-link">类</a></li><li><a href="/front-end-interview/js-essentials/js-common-functions.html" class="sidebar-link">ES6+ 一些常用功能</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="作用域"><a href="#作用域" aria-hidden="true" class="header-anchor">#</a> 作用域</h1><p>在 <code>JavaScript</code> 中 作用域的工作模式是 <strong>词法作用域（lexical scope）</strong>，标准中称为 <strong>词法环境（lexical environments）</strong>。</p><p>作用域（lexical environments）限定了变量的有效范围。ES6 之前（不包含 ES6），<code>JavaScript</code> 中只有函数和全局作用域。ES6 之后，<code>JavaScript</code> 有函数、全局和<strong>块级作用域</strong>。</p><p>块级作用域因 <code>let</code> 和 <code>const</code> 声明变量而出现，它<strong>只</strong>对 <code>let</code> 和 <code>const</code> 声明的变量有效。常见块级作用域有大括号内的区域，for 循环中的小括号区域，即条件区域。</p><p>当变量使用 <a href="https://www.ecma-international.org/ecma-262/8.0/#sec-variable-statement" target="_blank" rel="noopener noreferrer">var<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 声明时，分为函数体内和全局作用域两种情况。在函数体内使用 <code>var</code> 声明的变量只能在该函数体内使用，外部是无法调用该函数体内的声明变量。在全局作用域内声明的变量，可在任意位置调用。</p><p>当给一个变量赋值时，若之前未使用 <code>var</code>、<code>let</code>、<code>const</code> 之一的关键字显式声明该变量，那么该变量将默认隐式声明为全局变量。</p><p>为了规范变量的有效范围，防止变量提升（因为极易造成混乱，遵循 <code>先声明后调用</code> 的原则有利于后期维护。），ES6 定义了新的变量声明方式 —— <code>let</code> 或 <code>const</code>。由它们所定义的变量只能在声明时的代码块（<strong>块级作用域</strong>）内（即声明时所在的大括号内）使用。即使得变量只会出现在它们应该出现的区域。二者的不同是 <code>let</code> 声明的是初始化后<strong>可被修改</strong>的变量，<code>const</code> 声明的是初始化后<strong>不可被修改</strong>的变量（<code>constant variable</code>）。</p><h2 id="作用域链"><a href="#作用域链" aria-hidden="true" class="header-anchor">#</a> 作用域链</h2><p>不同于<a href="/front-end-interview/js-essentials/js-prototype.html">原型链</a>的是，作用域链的适用对象是变量，顶层（最外层）作用域是全局作用域。</p><p>原则：后代作用域能够访问在祖先作用域声明的变量，反之，不成立。</p><p>原理：在 <code>JavaScript</code> 中，当调用某个变量时（示例为 a），首先会找到当前被调用变量的声明，并且搜索始于当前作用域。在当前作用域内未找到 a 变量的声明时，会继续向上级父作用域搜索变量 a 的声明，依照这个规律直至变量 a 的声明被找到或搜索完全局作用域。这即是 <code>JavaScript</code> 中的作用域链的执行原理。</p><p>特别地，浏览器对于函数声明的处理如同处理 <code>var</code> 声明变量时一样（仅有函数内声明或全局声明），那么调用函数时的查找函数声明的原理同上。另外，函数的父级作用域是<strong>定义时</strong>的就已经确定的，而不是调用时确定。</p><p>使用 <code>let</code>和 <code>const</code> 声明变量，会形成块级作用域，那么使用他们声明变量优于使用 <code>var</code> 声明变量。因为他们更严格的限制了变量的有效范围，并形成了更为严格的作用域链，避免了因变量提升和非块级作用域导致的变量意外覆盖。那么这使得代码的健壮性得到大大提高。</p><h2 id="闭包"><a href="#闭包" aria-hidden="true" class="header-anchor">#</a> 闭包</h2><blockquote><p>自由变量
作用域链
闭包的两个场景</p></blockquote><p>闭包即是对作用域理解的实际应用。</p><p><strong>重要（应用闭包的原理）</strong>：</p><ol><li><p>闭包的父级作用域因与闭包关联（二者至少有一个联系，如一个变量引用）而得以保存。</p></li><li><p>闭包的父级作用域在<strong>创建</strong>（而非调用）闭包时确定。</p></li></ol><p>闭包的本质是一个函数，它是一个有权访问其他函数作用域的函数（出自 <code>JavaScript 高级程序设计</code>）。</p><p>通常情况下，函数在执行完成后，弹出调用栈，那么该函数内部的变量和作用域都将被销毁。但是，执行完该函数（指定为 a）返回一个函数（即返回一个闭包，或理解为形成一个闭包），那么此时 a 中的作用域和变量会在内存中保存到闭包不存在为止。</p><p>依据闭包形成对父级作用域和其中变量的影响，我们可以人为地去间接性（不能直接访问）临时性（生命周期因闭包是否存在而变化）存储我们所需要的一些变量。</p><p>以下示例展示控制台输出 0~9</p><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn0</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">fn0</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 等价</span>
<span class="token keyword">function</span> <span class="token function">fn1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过创建闭包并传入当前循环时的 i 值，将闭包与当前循环体内作用域关联，使得当前循环</span>
    <span class="token comment">// 时的作用域得以保存</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="let-在-for-循环中的应用"><a href="#let-在-for-循环中的应用" aria-hidden="true" class="header-anchor">#</a> let 在 for 循环中的应用</h3><p>fn0 中 <code>let</code> 声明变量 i 时，形成块级作用域，那么当前变量 i <strong>只在本轮循环有效</strong>（与 <code>var</code> 区分）。依据 <a href="https://www.ecma-international.org/ecma-262/8.0/#sec-for-statement-runtime-semantics-labelledevaluation" target="_blank" rel="noopener noreferrer">ES8 13.7.4.7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中 <code>IterationStatement:for(LexicalDeclarationExpression;Expression)Statement</code> 的相关解释：</p><p>在每次 for 循环结束时，会隐式的<strong>保存</strong>当前的执行上下文以及当前的循环结果（ES8 13.7.4.7 条款 12 和 9.a）。</p><p>在每次新的循环开始时，都会<strong>重新</strong>声明并<strong>重新</strong>绑定 (re-bind) 变量 i 为上一次循环结束时变量 i 的值，并继续判断循环条件进行或跳出循环（ES8 13.7.4.7 条款 2）。</p><p>此时的执行上下文中的变量 i 是与 <code>setTimeout()</code> 任务分发器中的函数是相关联的，就如同创建闭包时，闭包的父级作用域与闭包相关联。</p><p>其他参考：</p><ol><li><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20%26%20closures/ch3.md#let-loops" target="_blank" rel="noopener noreferrer">You dont know JS - let Loops<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20%26%20closures/ch3.md#let-loops" target="_blank" rel="noopener noreferrer">You dont know JS - Block Scoping Revisited<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol><h3 id="闭包在-for-循环中的应用"><a href="#闭包在-for-循环中的应用" aria-hidden="true" class="header-anchor">#</a> 闭包在 for 循环中的应用</h3><p>匿名自执行函数（必须传入变量 i，以维持对变量的引用。）形成一个闭包（针对 fn1），那么在循环时，当前的循环体内作用域链（其中包含当前变量 i 值）因与闭包关联而<strong>得以保存</strong>。进而在每次控制台输出 i 时，<code>setTimeout</code> 中的匿名函数<strong>向上</strong>查找变量 i 时，都是查找的分发匿名函数时的变量 i。因而每次输出的 i 都是之前循环的值。</p><h3 id="私有变量"><a href="#私有变量" aria-hidden="true" class="header-anchor">#</a> 私有变量</h3><p>依据调用函数时，在作用域链中查找函数声明的原理（详见上一节），函数的父级作用域是在 <strong>定义时</strong> 确定。那么可创建闭包来保护变量不被意外修改。</p><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _private <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 被保护的变量</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _private<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_private<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> addNum <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">addNum</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// [10]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>示例中，外部无法修改且无法访问 <code>_private</code> 变量，只有通过暴露的公有方法才能修改和访问 <code>_private</code>。</p><h3 id="私有函数"><a href="#私有函数" aria-hidden="true" class="header-anchor">#</a> 私有函数</h3><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">privateFn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`I am a private function`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">privateFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ins <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">ins</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在以上示例中，闭包是有权访问私有变量和私有函数的唯一公有接口。私有变量和私有函数对外都是不可访问不可修改的。</p><h3 id="闭包的弊端"><a href="#闭包的弊端" aria-hidden="true" class="header-anchor">#</a> 闭包的弊端</h3><p>因本节开头介绍闭包的存在机理，父级作用域及其中变量会一直在内存中保存至该闭包被销毁。那么据此引出，创建过多的闭包将<strong>可能导致内存溢出</strong>。</p></div><div class="content edit-link"><!----><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">6/16/2018, 5:46:28 PM</span></div></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/front-end-interview/js-essentials/js-hoisting.html" class="prev">
          变量提升
        </a></span><span class="next"><a href="/front-end-interview/js-essentials/js-prototype.html">
          原型和原型链
        </a> →
      </span></p></div></div></div></div>
    <script src="/front-end-interview/assets/js/13.66c864b0.js" defer></script><script src="/front-end-interview/assets/js/app.db72fc95.js" defer></script>
  </body>
</html>
